<Window
    x:Class="Tenpai.Views.MainWindow"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    xmlns:c="clr-namespace:CalcBinding;assembly=CalcBinding"
    xmlns:converters="clr-namespace:Tenpai.Converters"
    xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
    xmlns:helper="clr-namespace:Tenpai.Helpers"
    xmlns:i="http://schemas.microsoft.com/xaml/behaviors"
    xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
    xmlns:meld="clr-namespace:Tenpai.Models.Yaku.Meld"
    xmlns:sys="clr-namespace:System;assembly=mscorlib"
    xmlns:tiles="clr-namespace:Tenpai.Models.Tiles"
    xmlns:utils="clr-namespace:Tenpai.Utils"
    xmlns:viewModels="clr-namespace:Tenpai.ViewModels"
    xmlns:views="clr-namespace:Tenpai.Views"
    Title="聴牌 β"
    Width="1280"
    Height="720"
    mc:Ignorable="d">
    <Window.Resources>
        <converters:EnumConverter x:Key="Enum" />
        <converters:HanCountToIntConverter x:Key="HanCountToInt" />
        <converters:HanCountToStringConverter x:Key="HanCountToString" />
        <ObjectDataProvider
            x:Key="WindOfTheRoundComboBox"
            MethodName="GetValues"
            ObjectType="{x:Type utils:EnumerationManager}">
            <ObjectDataProvider.MethodParameters>
                <x:Type TypeName="viewModels:WindOfTheRound" />
            </ObjectDataProvider.MethodParameters>
        </ObjectDataProvider>
        <ObjectDataProvider
            x:Key="OnesOwnWindComboBox"
            MethodName="GetValues"
            ObjectType="{x:Type utils:EnumerationManager}">
            <ObjectDataProvider.MethodParameters>
                <x:Type TypeName="viewModels:OnesOwnWind" />
            </ObjectDataProvider.MethodParameters>
        </ObjectDataProvider>
        <converters:WindOfTheRoundConverter x:Key="WindOfTheRoundConverter" />
        <converters:OnesOwnWindConverter x:Key="OnesOwnWindConverter" />
        <converters:SlumConverter x:Key="CSlum" />
        <converters:OneAndAHalfOfSlumConverter x:Key="COneAndHalfOfSlum" />
        <converters:DoubleSlumConverter x:Key="CDoubleSlum" />
        <converters:ThreeTimesofTheSlumConverter x:Key="CThreeTimesOfTheSlum" />
        <converters:FullConverter x:Key="CFull" />
        <converters:DoubleFullConverter x:Key="CDoubleFull" />
        <converters:TripleFullConverter x:Key="CTripleFull" />
    </Window.Resources>
    <i:Interaction.Triggers>
        <i:EventTrigger EventName="Closing">
            <helper:EventToCommand Command="{Binding ClosingCommand}" />
        </i:EventTrigger>
    </i:Interaction.Triggers>
    <DockPanel>
        <DockPanel DockPanel.Dock="Top">
            <Menu>
                <MenuItem Header="ファイル(_F)">
                    <MenuItem Command="{Binding TestByOneImageCommand}" Header="1枚の画像で試験..." />
                    <MenuItem Command="{Binding ResetBackgroundCommand}" Header="背景をリセット" />
                    <MenuItem Command="{Binding TakePictureOnClientRectCommand}" Header="ClientRectを撮影" />
                </MenuItem>
            </Menu>
        </DockPanel>
        <DockPanel DockPanel.Dock="Right">
            <ScrollViewer>
                <ItemsControl ItemsSource="{Binding Yakus}">
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal">
                                <CheckBox
                                    VerticalAlignment="Center"
                                    Content="{Binding Name}"
                                    IsChecked="{Binding IsEnable.Value}">
                                    <i:Interaction.Triggers>
                                        <i:EventTrigger EventName="Checked">
                                            <helper:EventToCommand Command="{Binding CheckedCommand}" />
                                        </i:EventTrigger>
                                        <i:EventTrigger EventName="Unchecked">
                                            <helper:EventToCommand Command="{Binding UncheckedCommand}" />
                                        </i:EventTrigger>
                                    </i:Interaction.Triggers>
                                </CheckBox>
                                <Label VerticalAlignment="Center">
                                    <TextBlock>
                                        <Run>
                                            <Run.Text>
                                                <MultiBinding Converter="{StaticResource HanCountToString}" Mode="OneWay">
                                                    <Binding />
                                                    <Binding Path="DataContext.SarashiHai" RelativeSource="{RelativeSource Mode=FindAncestor, AncestorType=views:MainWindow}" />
                                                </MultiBinding>
                                            </Run.Text>
                                        </Run>
                                    </TextBlock>
                                </Label>
                            </StackPanel>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <StackPanel Orientation="Vertical" />
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                </ItemsControl>
            </ScrollViewer>
        </DockPanel>
        <DockPanel Margin="30" DockPanel.Dock="Top">
            <DockPanel DockPanel.Dock="Top">
                <StackPanel DockPanel.Dock="Right" Orientation="Vertical">
                    <StackPanel Orientation="Horizontal">
                        <views:TilePlaceholder
                            SelectCommand="{Binding SelectCommand}"
                            Tag="{Binding DataContext, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=views:MainWindow}}"
                            TileType="{Binding DoraDisplayTile0.Value, Mode=TwoWay}" />
                        <views:TilePlaceholder
                            SelectCommand="{Binding SelectCommand}"
                            Tag="{Binding DataContext, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=views:MainWindow}}"
                            TileType="{Binding DoraDisplayTile1.Value, Mode=TwoWay}" />
                        <views:TilePlaceholder
                            SelectCommand="{Binding SelectCommand}"
                            Tag="{Binding DataContext, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=views:MainWindow}}"
                            TileType="{Binding DoraDisplayTile2.Value, Mode=TwoWay}" />
                        <views:TilePlaceholder
                            SelectCommand="{Binding SelectCommand}"
                            Tag="{Binding DataContext, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=views:MainWindow}}"
                            TileType="{Binding DoraDisplayTile3.Value, Mode=TwoWay}" />
                        <views:TilePlaceholder
                            SelectCommand="{Binding SelectCommand}"
                            Tag="{Binding DataContext, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=views:MainWindow}}"
                            TileType="{Binding DoraDisplayTile4.Value, Mode=TwoWay}" />
                    </StackPanel>
                    <StackPanel DockPanel.Dock="Right" Orientation="Horizontal">
                        <views:TilePlaceholder
                            SelectCommand="{Binding SelectCommand}"
                            Tag="{Binding DataContext, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=views:MainWindow}}"
                            TileType="{Binding UraDoraDisplayTile0.Value, Mode=TwoWay}" />
                        <views:TilePlaceholder
                            SelectCommand="{Binding SelectCommand}"
                            Tag="{Binding DataContext, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=views:MainWindow}}"
                            TileType="{Binding UraDoraDisplayTile1.Value, Mode=TwoWay}" />
                        <views:TilePlaceholder
                            SelectCommand="{Binding SelectCommand}"
                            Tag="{Binding DataContext, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=views:MainWindow}}"
                            TileType="{Binding UraDoraDisplayTile2.Value, Mode=TwoWay}" />
                        <views:TilePlaceholder
                            SelectCommand="{Binding SelectCommand}"
                            Tag="{Binding DataContext, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=views:MainWindow}}"
                            TileType="{Binding UraDoraDisplayTile3.Value, Mode=TwoWay}" />
                        <views:TilePlaceholder
                            SelectCommand="{Binding SelectCommand}"
                            Tag="{Binding DataContext, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=views:MainWindow}}"
                            TileType="{Binding UraDoraDisplayTile4.Value, Mode=TwoWay}" />
                    </StackPanel>
                </StackPanel>
                <StackPanel DockPanel.Dock="Left" Orientation="Horizontal">
                    <StackPanel.Resources>
                        <Style TargetType="ComboBox">
                            <Setter Property="Width" Value="75" />
                            <Setter Property="Height" Value="40" />
                            <Setter Property="VerticalContentAlignment" Value="Center" />
                            <Setter Property="HorizontalContentAlignment" Value="Left" />
                            <Setter Property="FontSize" Value="20" />
                        </Style>
                    </StackPanel.Resources>
                    <ComboBox ItemsSource="{Binding Source={StaticResource WindOfTheRoundComboBox}}" SelectedItem="{Binding WindOfTheRound.Value, Mode=TwoWay, Converter={StaticResource WindOfTheRoundConverter}, UpdateSourceTrigger=PropertyChanged}" />
                    <ComboBox ItemsSource="{Binding Source={StaticResource OnesOwnWindComboBox}}" SelectedItem="{Binding OnesOwnWind.Value, Mode=TwoWay, Converter={StaticResource OnesOwnWindConverter}, UpdateSourceTrigger=PropertyChanged}" />
                    <ComboBox
                        Width="100"
                        ItemsSource="{Binding HonbaSu, Mode=OneWay}"
                        SelectedItem="{Binding SelectedHonbaSu.Value, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}">
                        <ComboBox.ItemTemplate>
                            <DataTemplate>
                                <TextBlock>
                                    <Run Text="{Binding Mode=OneWay}" />
                                    <Run Text="本場" />
                                </TextBlock>
                            </DataTemplate>
                        </ComboBox.ItemTemplate>
                    </ComboBox>
                </StackPanel>
            </DockPanel>
            <TabControl>
                <TabItem Header="手動">
                    <DockPanel>
                        <StackPanel Orientation="Horizontal">
                            <views:TilePlaceholder
                                SelectCommand="{Binding SelectCommand}"
                                Tag="{Binding DataContext, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=views:MainWindow}}"
                                TileType="{Binding Tile0.Value, Mode=TwoWay}"
                                Visibility="{Binding Tile0.Value.Visibility.Value}">
                                <views:TilePlaceholder.ContextMenu>
                                    <ContextMenu ItemsSource="{Binding Tag.ContextMenuItems, RelativeSource={RelativeSource Self}}" Tag="{Binding PlacementTarget.Tag, RelativeSource={RelativeSource Self}}">
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="Opened">
                                                <helper:EventToCommand Command="{Binding Tag.ContextMenuOpeningCommand, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ContextMenu}}" CommandParameter="0" />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>
                                    </ContextMenu>
                                </views:TilePlaceholder.ContextMenu>
                            </views:TilePlaceholder>
                            <views:TilePlaceholder
                                SelectCommand="{Binding SelectCommand}"
                                Tag="{Binding DataContext, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=views:MainWindow}}"
                                TileType="{Binding Tile1.Value, Mode=TwoWay}"
                                Visibility="{Binding Tile1.Value.Visibility.Value}">
                                <views:TilePlaceholder.ContextMenu>
                                    <ContextMenu ItemsSource="{Binding Tag.ContextMenuItems, RelativeSource={RelativeSource Self}}" Tag="{Binding PlacementTarget.Tag, RelativeSource={RelativeSource Self}}">
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="Opened">
                                                <helper:EventToCommand Command="{Binding Tag.ContextMenuOpeningCommand, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ContextMenu}}" CommandParameter="1" />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>
                                    </ContextMenu>
                                </views:TilePlaceholder.ContextMenu>
                            </views:TilePlaceholder>
                            <views:TilePlaceholder
                                SelectCommand="{Binding SelectCommand}"
                                Tag="{Binding DataContext, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=views:MainWindow}}"
                                TileType="{Binding Tile2.Value, Mode=TwoWay}"
                                Visibility="{Binding Tile2.Value.Visibility.Value}">
                                <views:TilePlaceholder.ContextMenu>
                                    <ContextMenu ItemsSource="{Binding Tag.ContextMenuItems, RelativeSource={RelativeSource Self}}" Tag="{Binding PlacementTarget.Tag, RelativeSource={RelativeSource Self}}">
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="Opened">
                                                <helper:EventToCommand Command="{Binding Tag.ContextMenuOpeningCommand, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ContextMenu}}" CommandParameter="2" />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>
                                    </ContextMenu>
                                </views:TilePlaceholder.ContextMenu>
                            </views:TilePlaceholder>
                            <views:TilePlaceholder
                                SelectCommand="{Binding SelectCommand}"
                                Tag="{Binding DataContext, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=views:MainWindow}}"
                                TileType="{Binding Tile3.Value, Mode=TwoWay}"
                                Visibility="{Binding Tile3.Value.Visibility.Value}">
                                <views:TilePlaceholder.ContextMenu>
                                    <ContextMenu ItemsSource="{Binding Tag.ContextMenuItems, RelativeSource={RelativeSource Self}}" Tag="{Binding PlacementTarget.Tag, RelativeSource={RelativeSource Self}}">
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="Opened">
                                                <helper:EventToCommand Command="{Binding Tag.ContextMenuOpeningCommand, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ContextMenu}}" CommandParameter="3" />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>
                                    </ContextMenu>
                                </views:TilePlaceholder.ContextMenu>
                            </views:TilePlaceholder>
                            <views:TilePlaceholder
                                SelectCommand="{Binding SelectCommand}"
                                Tag="{Binding DataContext, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=views:MainWindow}}"
                                TileType="{Binding Tile4.Value, Mode=TwoWay}"
                                Visibility="{Binding Tile4.Value.Visibility.Value}">
                                <views:TilePlaceholder.ContextMenu>
                                    <ContextMenu ItemsSource="{Binding Tag.ContextMenuItems, RelativeSource={RelativeSource Self}}" Tag="{Binding PlacementTarget.Tag, RelativeSource={RelativeSource Self}}">
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="Opened">
                                                <helper:EventToCommand Command="{Binding Tag.ContextMenuOpeningCommand, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ContextMenu}}" CommandParameter="4" />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>
                                    </ContextMenu>
                                </views:TilePlaceholder.ContextMenu>
                            </views:TilePlaceholder>
                            <views:TilePlaceholder
                                SelectCommand="{Binding SelectCommand}"
                                Tag="{Binding DataContext, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=views:MainWindow}}"
                                TileType="{Binding Tile5.Value, Mode=TwoWay}"
                                Visibility="{Binding Tile5.Value.Visibility.Value}">
                                <views:TilePlaceholder.ContextMenu>
                                    <ContextMenu ItemsSource="{Binding Tag.ContextMenuItems, RelativeSource={RelativeSource Self}}" Tag="{Binding PlacementTarget.Tag, RelativeSource={RelativeSource Self}}">
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="Opened">
                                                <helper:EventToCommand Command="{Binding Tag.ContextMenuOpeningCommand, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ContextMenu}}" CommandParameter="5" />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>
                                    </ContextMenu>
                                </views:TilePlaceholder.ContextMenu>
                            </views:TilePlaceholder>
                            <views:TilePlaceholder
                                SelectCommand="{Binding SelectCommand}"
                                Tag="{Binding DataContext, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=views:MainWindow}}"
                                TileType="{Binding Tile6.Value, Mode=TwoWay}"
                                Visibility="{Binding Tile6.Value.Visibility.Value}">
                                <views:TilePlaceholder.ContextMenu>
                                    <ContextMenu ItemsSource="{Binding Tag.ContextMenuItems, RelativeSource={RelativeSource Self}}" Tag="{Binding PlacementTarget.Tag, RelativeSource={RelativeSource Self}}">
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="Opened">
                                                <helper:EventToCommand Command="{Binding Tag.ContextMenuOpeningCommand, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ContextMenu}}" CommandParameter="6" />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>
                                    </ContextMenu>
                                </views:TilePlaceholder.ContextMenu>
                            </views:TilePlaceholder>
                            <views:TilePlaceholder
                                SelectCommand="{Binding SelectCommand}"
                                Tag="{Binding DataContext, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=views:MainWindow}}"
                                TileType="{Binding Tile7.Value, Mode=TwoWay}"
                                Visibility="{Binding Tile7.Value.Visibility.Value}">
                                <views:TilePlaceholder.ContextMenu>
                                    <ContextMenu ItemsSource="{Binding Tag.ContextMenuItems, RelativeSource={RelativeSource Self}}" Tag="{Binding PlacementTarget.Tag, RelativeSource={RelativeSource Self}}">
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="Opened">
                                                <helper:EventToCommand Command="{Binding Tag.ContextMenuOpeningCommand, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ContextMenu}}" CommandParameter="7" />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>
                                    </ContextMenu>
                                </views:TilePlaceholder.ContextMenu>
                            </views:TilePlaceholder>
                            <views:TilePlaceholder
                                SelectCommand="{Binding SelectCommand}"
                                Tag="{Binding DataContext, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=views:MainWindow}}"
                                TileType="{Binding Tile8.Value, Mode=TwoWay}"
                                Visibility="{Binding Tile8.Value.Visibility.Value}">
                                <views:TilePlaceholder.ContextMenu>
                                    <ContextMenu ItemsSource="{Binding Tag.ContextMenuItems, RelativeSource={RelativeSource Self}}" Tag="{Binding PlacementTarget.Tag, RelativeSource={RelativeSource Self}}">
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="Opened">
                                                <helper:EventToCommand Command="{Binding Tag.ContextMenuOpeningCommand, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ContextMenu}}" CommandParameter="8" />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>
                                    </ContextMenu>
                                </views:TilePlaceholder.ContextMenu>
                            </views:TilePlaceholder>
                            <views:TilePlaceholder
                                SelectCommand="{Binding SelectCommand}"
                                Tag="{Binding DataContext, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=views:MainWindow}}"
                                TileType="{Binding Tile9.Value, Mode=TwoWay}"
                                Visibility="{Binding Tile9.Value.Visibility.Value}">
                                <views:TilePlaceholder.ContextMenu>
                                    <ContextMenu ItemsSource="{Binding Tag.ContextMenuItems, RelativeSource={RelativeSource Self}}" Tag="{Binding PlacementTarget.Tag, RelativeSource={RelativeSource Self}}">
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="Opened">
                                                <helper:EventToCommand Command="{Binding Tag.ContextMenuOpeningCommand, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ContextMenu}}" CommandParameter="9" />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>
                                    </ContextMenu>
                                </views:TilePlaceholder.ContextMenu>
                            </views:TilePlaceholder>
                            <views:TilePlaceholder
                                SelectCommand="{Binding SelectCommand}"
                                Tag="{Binding DataContext, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=views:MainWindow}}"
                                TileType="{Binding Tile10.Value, Mode=TwoWay}"
                                Visibility="{Binding Tile10.Value.Visibility.Value}">
                                <views:TilePlaceholder.ContextMenu>
                                    <ContextMenu ItemsSource="{Binding Tag.ContextMenuItems, RelativeSource={RelativeSource Self}}" Tag="{Binding PlacementTarget.Tag, RelativeSource={RelativeSource Self}}">
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="Opened">
                                                <helper:EventToCommand Command="{Binding Tag.ContextMenuOpeningCommand, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ContextMenu}}" CommandParameter="10" />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>
                                    </ContextMenu>
                                </views:TilePlaceholder.ContextMenu>
                            </views:TilePlaceholder>
                            <views:TilePlaceholder
                                SelectCommand="{Binding SelectCommand}"
                                Tag="{Binding DataContext, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=views:MainWindow}}"
                                TileType="{Binding Tile11.Value, Mode=TwoWay}"
                                Visibility="{Binding Tile11.Value.Visibility.Value}">
                                <views:TilePlaceholder.ContextMenu>
                                    <ContextMenu ItemsSource="{Binding Tag.ContextMenuItems, RelativeSource={RelativeSource Self}}" Tag="{Binding PlacementTarget.Tag, RelativeSource={RelativeSource Self}}">
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="Opened">
                                                <helper:EventToCommand Command="{Binding Tag.ContextMenuOpeningCommand, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ContextMenu}}" CommandParameter="11" />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>
                                    </ContextMenu>
                                </views:TilePlaceholder.ContextMenu>
                            </views:TilePlaceholder>
                            <views:TilePlaceholder
                                SelectCommand="{Binding SelectCommand}"
                                Tag="{Binding DataContext, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=views:MainWindow}}"
                                TileType="{Binding Tile12.Value, Mode=TwoWay}"
                                Visibility="{Binding Tile12.Value.Visibility.Value}">
                                <views:TilePlaceholder.ContextMenu>
                                    <ContextMenu ItemsSource="{Binding Tag.ContextMenuItems, RelativeSource={RelativeSource Self}}" Tag="{Binding PlacementTarget.Tag, RelativeSource={RelativeSource Self}}">
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="Opened">
                                                <helper:EventToCommand Command="{Binding Tag.ContextMenuOpeningCommand, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ContextMenu}}" CommandParameter="12" />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>
                                    </ContextMenu>
                                </views:TilePlaceholder.ContextMenu>
                            </views:TilePlaceholder>
                            <views:TilePlaceholder
                                SelectCommand="{Binding SelectCommand}"
                                Tag="{Binding DataContext, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=views:MainWindow}}"
                                TileType="{Binding Tile13.Value, Mode=TwoWay}"
                                Visibility="{Binding Tile13.Value.Visibility.Value}">
                                <views:TilePlaceholder.ContextMenu>
                                    <ContextMenu ItemsSource="{Binding Tag.ContextMenuItems, RelativeSource={RelativeSource Self}}" Tag="{Binding PlacementTarget.Tag, RelativeSource={RelativeSource Self}}">
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="Opened">
                                                <helper:EventToCommand Command="{Binding Tag.ContextMenuOpeningCommand, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ContextMenu}}" CommandParameter="13" />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>
                                    </ContextMenu>
                                </views:TilePlaceholder.ContextMenu>
                            </views:TilePlaceholder>
                            <views:TilePlaceholder
                                SelectCommand="{Binding SelectCommand}"
                                Tag="{Binding DataContext, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=views:MainWindow}}"
                                TileType="{Binding Tile14.Value, Mode=TwoWay}"
                                Visibility="{Binding Tile14.Value.Visibility.Value}">
                                <views:TilePlaceholder.ContextMenu>
                                    <ContextMenu ItemsSource="{Binding Tag.ContextMenuItems, RelativeSource={RelativeSource Self}}" Tag="{Binding PlacementTarget.Tag, RelativeSource={RelativeSource Self}}">
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="Opened">
                                                <helper:EventToCommand Command="{Binding Tag.ContextMenuOpeningCommand, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ContextMenu}}" CommandParameter="14" />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>
                                    </ContextMenu>
                                </views:TilePlaceholder.ContextMenu>
                            </views:TilePlaceholder>
                            <views:TilePlaceholder
                                SelectCommand="{Binding SelectCommand}"
                                Tag="{Binding DataContext, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=views:MainWindow}}"
                                TileType="{Binding Tile15.Value, Mode=TwoWay}"
                                Visibility="{Binding Tile15.Value.Visibility.Value}">
                                <views:TilePlaceholder.ContextMenu>
                                    <ContextMenu ItemsSource="{Binding Tag.ContextMenuItems, RelativeSource={RelativeSource Self}}" Tag="{Binding PlacementTarget.Tag, RelativeSource={RelativeSource Self}}">
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="Opened">
                                                <helper:EventToCommand Command="{Binding Tag.ContextMenuOpeningCommand, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ContextMenu}}" CommandParameter="15" />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>
                                    </ContextMenu>
                                </views:TilePlaceholder.ContextMenu>
                            </views:TilePlaceholder>
                            <views:TilePlaceholder
                                SelectCommand="{Binding SelectCommand}"
                                Tag="{Binding DataContext, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=views:MainWindow}}"
                                TileType="{Binding Tile16.Value, Mode=TwoWay}"
                                Visibility="{Binding Tile16.Value.Visibility.Value}">
                                <views:TilePlaceholder.ContextMenu>
                                    <ContextMenu ItemsSource="{Binding Tag.ContextMenuItems, RelativeSource={RelativeSource Self}}" Tag="{Binding PlacementTarget.Tag, RelativeSource={RelativeSource Self}}">
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="Opened">
                                                <helper:EventToCommand Command="{Binding Tag.ContextMenuOpeningCommand, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ContextMenu}}" CommandParameter="16" />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>
                                    </ContextMenu>
                                </views:TilePlaceholder.ContextMenu>
                            </views:TilePlaceholder>
                            <views:TilePlaceholder
                                Margin="10"
                                SelectCommand="{Binding SelectAgariTileCommand}"
                                Tag="{Binding DataContext, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=views:MainWindow}}"
                                TileType="{Binding AgariTile.Value, Mode=TwoWay}"
                                Visibility="{Binding AgariTile.Value.Visibility.Value}">
                                <views:TilePlaceholder.ContextMenu>
                                    <ContextMenu ItemsSource="{Binding Tag.ContextMenuItems, RelativeSource={RelativeSource Self}}" Tag="{Binding PlacementTarget.Tag, RelativeSource={RelativeSource Self}}">
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="Opened">
                                                <helper:EventToCommand Command="{Binding Tag.ContextMenuOpeningCommand, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ContextMenu}}" CommandParameter="17" />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>
                                    </ContextMenu>
                                </views:TilePlaceholder.ContextMenu>
                            </views:TilePlaceholder>
                            <ContentControl VerticalAlignment="Center" Content="{Binding}">
                                <ContentControl.Style>
                                    <Style TargetType="ContentControl">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding AgariTypeAsInt.Value, Converter={StaticResource Enum}, ConverterParameter={x:Static viewModels:AgariType.Unspecified}}" Value="True">
                                                <Setter Property="ContentTemplate">
                                                    <Setter.Value>
                                                        <DataTemplate />
                                                    </Setter.Value>
                                                </Setter>
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding AgariTypeAsInt.Value, Converter={StaticResource Enum}, ConverterParameter={x:Static viewModels:AgariType.Tsumo}}" Value="True">
                                                <Setter Property="ContentTemplate">
                                                    <Setter.Value>
                                                        <DataTemplate>
                                                            <DataTemplate.Resources>
                                                                <Style TargetType="Label">
                                                                    <Setter Property="FontSize" Value="30" />
                                                                    <Setter Property="FontFamily" Value="HGS行書体" />
                                                                </Style>
                                                            </DataTemplate.Resources>
                                                            <Label Content="ツモ" />
                                                        </DataTemplate>
                                                    </Setter.Value>
                                                </Setter>
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding AgariTypeAsInt.Value, Converter={StaticResource Enum}, ConverterParameter={x:Static viewModels:AgariType.Ron}}" Value="True">
                                                <Setter Property="ContentTemplate">
                                                    <Setter.Value>
                                                        <DataTemplate>
                                                            <DataTemplate.Resources>
                                                                <Style TargetType="Label">
                                                                    <Setter Property="FontSize" Value="30" />
                                                                    <Setter Property="FontFamily" Value="HGS行書体" />
                                                                </Style>
                                                            </DataTemplate.Resources>
                                                            <Label Content="ロン" />
                                                        </DataTemplate>
                                                    </Setter.Value>
                                                </Setter>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </ContentControl.Style>
                            </ContentControl>
                        </StackPanel>
                        <DockPanel DockPanel.Dock="Right">
                            <StackPanel Orientation="Horizontal">
                                <ItemsControl VerticalAlignment="Center" ItemsSource="{Binding SarashiHai}">
                                    <ItemsControl.ItemTemplateSelector>
                                        <helper:MeldItemTemplateSelector>
                                            <DataTemplate DataType="{x:Type meld:Run}">
                                                <StackPanel Orientation="Horizontal">
                                                    <views:TilePlaceholder LayoutTransform="{Binding Tiles[0].Rotate}" TileType="{Binding Tiles[0]}" />
                                                    <views:TilePlaceholder LayoutTransform="{Binding Tiles[1].Rotate}" TileType="{Binding Tiles[1]}" />
                                                    <views:TilePlaceholder LayoutTransform="{Binding Tiles[2].Rotate}" TileType="{Binding Tiles[2]}" />
                                                </StackPanel>
                                            </DataTemplate>
                                            <DataTemplate DataType="{x:Type meld:Triple}">
                                                <StackPanel Orientation="Horizontal" Tag="{Binding DataContext, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=views:MainWindow}}">
                                                    <StackPanel.ContextMenu>
                                                        <ContextMenu ItemsSource="{Binding Tag.SarashiHaiTripleContextMenuItems, RelativeSource={RelativeSource Self}}" Tag="{Binding PlacementTarget.Tag, RelativeSource={RelativeSource Self}}">
                                                            <i:Interaction.Triggers>
                                                                <i:EventTrigger EventName="Opened">
                                                                    <helper:EventToCommand Command="{Binding Tag.SarashiHaiTripleContextMenuOpeningCommand, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ContextMenu}}" CommandParameter="{Binding AllTiles[0]}" />
                                                                </i:EventTrigger>
                                                            </i:Interaction.Triggers>
                                                        </ContextMenu>
                                                    </StackPanel.ContextMenu>
                                                    <views:TilePlaceholder LayoutTransform="{Binding Tiles[0].Rotate}" TileType="{Binding Tiles[0]}" />
                                                    <views:TilePlaceholder LayoutTransform="{Binding Tiles[1].Rotate}" TileType="{Binding Tiles[1]}" />
                                                    <views:TilePlaceholder LayoutTransform="{Binding Tiles[2].Rotate}" TileType="{Binding Tiles[2]}" />
                                                </StackPanel>
                                            </DataTemplate>
                                            <DataTemplate DataType="{x:Type meld:Quad}">
                                                <ContentControl Content="{Binding}">
                                                    <ContentControl.Style>
                                                        <Style TargetType="ContentControl">
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding TypeAsInt, Converter={StaticResource Enum}, ConverterParameter={x:Static meld:KongType.ConcealedKong}}" Value="True">
                                                                    <Setter Property="ContentTemplate">
                                                                        <Setter.Value>
                                                                            <DataTemplate>
                                                                                <StackPanel Orientation="Horizontal">
                                                                                    <views:TilePlaceholder BackVisibility="Visible" TileType="{Binding Tiles[0]}" />
                                                                                    <views:TilePlaceholder TileType="{Binding Tiles[1]}" />
                                                                                    <views:TilePlaceholder TileType="{Binding Tiles[2]}" />
                                                                                    <views:TilePlaceholder BackVisibility="Visible" TileType="{Binding Tiles[3]}" />
                                                                                </StackPanel>
                                                                            </DataTemplate>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Binding TypeAsInt, Converter={StaticResource Enum}, ConverterParameter={x:Static meld:KongType.LargeMeldedKong}}" Value="True">
                                                                    <Setter Property="ContentTemplate">
                                                                        <Setter.Value>
                                                                            <DataTemplate>
                                                                                <StackPanel Orientation="Horizontal">
                                                                                    <views:TilePlaceholder LayoutTransform="{Binding Tiles[0].Rotate}" TileType="{Binding Tiles[0]}" />
                                                                                    <views:TilePlaceholder LayoutTransform="{Binding Tiles[1].Rotate}" TileType="{Binding Tiles[1]}" />
                                                                                    <views:TilePlaceholder LayoutTransform="{Binding Tiles[2].Rotate}" TileType="{Binding Tiles[2]}" />
                                                                                    <views:TilePlaceholder LayoutTransform="{Binding Tiles[3].Rotate}" TileType="{Binding Tiles[3]}" />
                                                                                </StackPanel>
                                                                            </DataTemplate>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Binding TypeAsInt, Converter={StaticResource Enum}, ConverterParameter={x:Static meld:KongType.SmallMeldedKong}}" Value="True">
                                                                    <Setter Property="ContentTemplate">
                                                                        <Setter.Value>
                                                                            <DataTemplate>
                                                                                <views:ShouminkanCandidate />
                                                                            </DataTemplate>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </ContentControl.Style>
                                                </ContentControl>
                                            </DataTemplate>
                                        </helper:MeldItemTemplateSelector>
                                    </ItemsControl.ItemTemplateSelector>
                                    <ItemsControl.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <StackPanel Orientation="Horizontal" />
                                        </ItemsPanelTemplate>
                                    </ItemsControl.ItemsPanel>
                                </ItemsControl>
                                <Button
                                    Width="75"
                                    Height="40"
                                    Command="{Binding ClearCommand}"
                                    Content="クリア" />
                            </StackPanel>
                        </DockPanel>
                    </DockPanel>
                </TabItem>
                <TabItem Header="自動">
                    <DockPanel>
                        <StackPanel DockPanel.Dock="Top" Orientation="Horizontal">
                            <Label
                                VerticalAlignment="Center"
                                Content="プロセス："
                                DockPanel.Dock="Left" />
                            <ComboBox
                                x:Name="ComboBox_SelectProcess"
                                Width="200"
                                ItemsSource="{Binding ProcessItems, UpdateSourceTrigger=PropertyChanged}"
                                SelectedItem="{Binding SelectedProcess.Value}">
                                <i:Interaction.Triggers>
                                    <i:EventTrigger EventName="DropDownOpened">
                                        <helper:EventToCommand Command="{Binding DropDownOpenedCommand}" />
                                    </i:EventTrigger>
                                </i:Interaction.Triggers>
                            </ComboBox>
                            <Label
                                VerticalAlignment="Center"
                                Content="Window"
                                DockPanel.Dock="Left" />
                            <ComboBox
                                x:Name="ComboBox_SelectWindow"
                                Width="200"
                                ItemsSource="{Binding WindowInfos, UpdateSourceTrigger=PropertyChanged}"
                                SelectedItem="{Binding SelectedWindowInfo.Value}" />
                            <CheckBox
                                x:Name="CheckBox_EnableToRenderAnalysisResult"
                                Margin="5"
                                Content="解析結果をレンダリングする"
                                IsChecked="{Binding EnableToRenderAnalysisResult.Value}" />
                        </StackPanel>
                        <StackPanel Orientation="Horizontal">
                            <views:TilePlaceholder
                                SelectCommand="{Binding SelectCommand}"
                                Tag="{Binding DataContext, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=views:MainWindow}}"
                                TileType="{Binding Tile0.Value, Mode=TwoWay}"
                                Visibility="{Binding Tile0.Value.Visibility.Value}">
                                <views:TilePlaceholder.ContextMenu>
                                    <ContextMenu ItemsSource="{Binding Tag.ContextMenuItems, RelativeSource={RelativeSource Self}}" Tag="{Binding PlacementTarget.Tag, RelativeSource={RelativeSource Self}}">
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="Opened">
                                                <helper:EventToCommand Command="{Binding Tag.ContextMenuOpeningCommand, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ContextMenu}}" CommandParameter="0" />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>
                                    </ContextMenu>
                                </views:TilePlaceholder.ContextMenu>
                            </views:TilePlaceholder>
                            <views:TilePlaceholder
                                SelectCommand="{Binding SelectCommand}"
                                Tag="{Binding DataContext, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=views:MainWindow}}"
                                TileType="{Binding Tile1.Value, Mode=TwoWay}"
                                Visibility="{Binding Tile1.Value.Visibility.Value}">
                                <views:TilePlaceholder.ContextMenu>
                                    <ContextMenu ItemsSource="{Binding Tag.ContextMenuItems, RelativeSource={RelativeSource Self}}" Tag="{Binding PlacementTarget.Tag, RelativeSource={RelativeSource Self}}">
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="Opened">
                                                <helper:EventToCommand Command="{Binding Tag.ContextMenuOpeningCommand, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ContextMenu}}" CommandParameter="1" />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>
                                    </ContextMenu>
                                </views:TilePlaceholder.ContextMenu>
                            </views:TilePlaceholder>
                            <views:TilePlaceholder
                                SelectCommand="{Binding SelectCommand}"
                                Tag="{Binding DataContext, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=views:MainWindow}}"
                                TileType="{Binding Tile2.Value, Mode=TwoWay}"
                                Visibility="{Binding Tile2.Value.Visibility.Value}">
                                <views:TilePlaceholder.ContextMenu>
                                    <ContextMenu ItemsSource="{Binding Tag.ContextMenuItems, RelativeSource={RelativeSource Self}}" Tag="{Binding PlacementTarget.Tag, RelativeSource={RelativeSource Self}}">
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="Opened">
                                                <helper:EventToCommand Command="{Binding Tag.ContextMenuOpeningCommand, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ContextMenu}}" CommandParameter="2" />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>
                                    </ContextMenu>
                                </views:TilePlaceholder.ContextMenu>
                            </views:TilePlaceholder>
                            <views:TilePlaceholder
                                SelectCommand="{Binding SelectCommand}"
                                Tag="{Binding DataContext, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=views:MainWindow}}"
                                TileType="{Binding Tile3.Value, Mode=TwoWay}"
                                Visibility="{Binding Tile3.Value.Visibility.Value}">
                                <views:TilePlaceholder.ContextMenu>
                                    <ContextMenu ItemsSource="{Binding Tag.ContextMenuItems, RelativeSource={RelativeSource Self}}" Tag="{Binding PlacementTarget.Tag, RelativeSource={RelativeSource Self}}">
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="Opened">
                                                <helper:EventToCommand Command="{Binding Tag.ContextMenuOpeningCommand, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ContextMenu}}" CommandParameter="3" />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>
                                    </ContextMenu>
                                </views:TilePlaceholder.ContextMenu>
                            </views:TilePlaceholder>
                            <views:TilePlaceholder
                                SelectCommand="{Binding SelectCommand}"
                                Tag="{Binding DataContext, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=views:MainWindow}}"
                                TileType="{Binding Tile4.Value, Mode=TwoWay}"
                                Visibility="{Binding Tile4.Value.Visibility.Value}">
                                <views:TilePlaceholder.ContextMenu>
                                    <ContextMenu ItemsSource="{Binding Tag.ContextMenuItems, RelativeSource={RelativeSource Self}}" Tag="{Binding PlacementTarget.Tag, RelativeSource={RelativeSource Self}}">
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="Opened">
                                                <helper:EventToCommand Command="{Binding Tag.ContextMenuOpeningCommand, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ContextMenu}}" CommandParameter="4" />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>
                                    </ContextMenu>
                                </views:TilePlaceholder.ContextMenu>
                            </views:TilePlaceholder>
                            <views:TilePlaceholder
                                SelectCommand="{Binding SelectCommand}"
                                Tag="{Binding DataContext, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=views:MainWindow}}"
                                TileType="{Binding Tile5.Value, Mode=TwoWay}"
                                Visibility="{Binding Tile5.Value.Visibility.Value}">
                                <views:TilePlaceholder.ContextMenu>
                                    <ContextMenu ItemsSource="{Binding Tag.ContextMenuItems, RelativeSource={RelativeSource Self}}" Tag="{Binding PlacementTarget.Tag, RelativeSource={RelativeSource Self}}">
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="Opened">
                                                <helper:EventToCommand Command="{Binding Tag.ContextMenuOpeningCommand, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ContextMenu}}" CommandParameter="5" />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>
                                    </ContextMenu>
                                </views:TilePlaceholder.ContextMenu>
                            </views:TilePlaceholder>
                            <views:TilePlaceholder
                                SelectCommand="{Binding SelectCommand}"
                                Tag="{Binding DataContext, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=views:MainWindow}}"
                                TileType="{Binding Tile6.Value, Mode=TwoWay}"
                                Visibility="{Binding Tile6.Value.Visibility.Value}">
                                <views:TilePlaceholder.ContextMenu>
                                    <ContextMenu ItemsSource="{Binding Tag.ContextMenuItems, RelativeSource={RelativeSource Self}}" Tag="{Binding PlacementTarget.Tag, RelativeSource={RelativeSource Self}}">
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="Opened">
                                                <helper:EventToCommand Command="{Binding Tag.ContextMenuOpeningCommand, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ContextMenu}}" CommandParameter="6" />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>
                                    </ContextMenu>
                                </views:TilePlaceholder.ContextMenu>
                            </views:TilePlaceholder>
                            <views:TilePlaceholder
                                SelectCommand="{Binding SelectCommand}"
                                Tag="{Binding DataContext, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=views:MainWindow}}"
                                TileType="{Binding Tile7.Value, Mode=TwoWay}"
                                Visibility="{Binding Tile7.Value.Visibility.Value}">
                                <views:TilePlaceholder.ContextMenu>
                                    <ContextMenu ItemsSource="{Binding Tag.ContextMenuItems, RelativeSource={RelativeSource Self}}" Tag="{Binding PlacementTarget.Tag, RelativeSource={RelativeSource Self}}">
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="Opened">
                                                <helper:EventToCommand Command="{Binding Tag.ContextMenuOpeningCommand, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ContextMenu}}" CommandParameter="7" />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>
                                    </ContextMenu>
                                </views:TilePlaceholder.ContextMenu>
                            </views:TilePlaceholder>
                            <views:TilePlaceholder
                                SelectCommand="{Binding SelectCommand}"
                                Tag="{Binding DataContext, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=views:MainWindow}}"
                                TileType="{Binding Tile8.Value, Mode=TwoWay}"
                                Visibility="{Binding Tile8.Value.Visibility.Value}">
                                <views:TilePlaceholder.ContextMenu>
                                    <ContextMenu ItemsSource="{Binding Tag.ContextMenuItems, RelativeSource={RelativeSource Self}}" Tag="{Binding PlacementTarget.Tag, RelativeSource={RelativeSource Self}}">
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="Opened">
                                                <helper:EventToCommand Command="{Binding Tag.ContextMenuOpeningCommand, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ContextMenu}}" CommandParameter="8" />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>
                                    </ContextMenu>
                                </views:TilePlaceholder.ContextMenu>
                            </views:TilePlaceholder>
                            <views:TilePlaceholder
                                SelectCommand="{Binding SelectCommand}"
                                Tag="{Binding DataContext, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=views:MainWindow}}"
                                TileType="{Binding Tile9.Value, Mode=TwoWay}"
                                Visibility="{Binding Tile9.Value.Visibility.Value}">
                                <views:TilePlaceholder.ContextMenu>
                                    <ContextMenu ItemsSource="{Binding Tag.ContextMenuItems, RelativeSource={RelativeSource Self}}" Tag="{Binding PlacementTarget.Tag, RelativeSource={RelativeSource Self}}">
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="Opened">
                                                <helper:EventToCommand Command="{Binding Tag.ContextMenuOpeningCommand, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ContextMenu}}" CommandParameter="9" />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>
                                    </ContextMenu>
                                </views:TilePlaceholder.ContextMenu>
                            </views:TilePlaceholder>
                            <views:TilePlaceholder
                                SelectCommand="{Binding SelectCommand}"
                                Tag="{Binding DataContext, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=views:MainWindow}}"
                                TileType="{Binding Tile10.Value, Mode=TwoWay}"
                                Visibility="{Binding Tile10.Value.Visibility.Value}">
                                <views:TilePlaceholder.ContextMenu>
                                    <ContextMenu ItemsSource="{Binding Tag.ContextMenuItems, RelativeSource={RelativeSource Self}}" Tag="{Binding PlacementTarget.Tag, RelativeSource={RelativeSource Self}}">
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="Opened">
                                                <helper:EventToCommand Command="{Binding Tag.ContextMenuOpeningCommand, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ContextMenu}}" CommandParameter="10" />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>
                                    </ContextMenu>
                                </views:TilePlaceholder.ContextMenu>
                            </views:TilePlaceholder>
                            <views:TilePlaceholder
                                SelectCommand="{Binding SelectCommand}"
                                Tag="{Binding DataContext, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=views:MainWindow}}"
                                TileType="{Binding Tile11.Value, Mode=TwoWay}"
                                Visibility="{Binding Tile11.Value.Visibility.Value}">
                                <views:TilePlaceholder.ContextMenu>
                                    <ContextMenu ItemsSource="{Binding Tag.ContextMenuItems, RelativeSource={RelativeSource Self}}" Tag="{Binding PlacementTarget.Tag, RelativeSource={RelativeSource Self}}">
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="Opened">
                                                <helper:EventToCommand Command="{Binding Tag.ContextMenuOpeningCommand, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ContextMenu}}" CommandParameter="11" />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>
                                    </ContextMenu>
                                </views:TilePlaceholder.ContextMenu>
                            </views:TilePlaceholder>
                            <views:TilePlaceholder
                                SelectCommand="{Binding SelectCommand}"
                                Tag="{Binding DataContext, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=views:MainWindow}}"
                                TileType="{Binding Tile12.Value, Mode=TwoWay}"
                                Visibility="{Binding Tile12.Value.Visibility.Value}">
                                <views:TilePlaceholder.ContextMenu>
                                    <ContextMenu ItemsSource="{Binding Tag.ContextMenuItems, RelativeSource={RelativeSource Self}}" Tag="{Binding PlacementTarget.Tag, RelativeSource={RelativeSource Self}}">
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="Opened">
                                                <helper:EventToCommand Command="{Binding Tag.ContextMenuOpeningCommand, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ContextMenu}}" CommandParameter="12" />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>
                                    </ContextMenu>
                                </views:TilePlaceholder.ContextMenu>
                            </views:TilePlaceholder>
                            <views:TilePlaceholder
                                SelectCommand="{Binding SelectCommand}"
                                Tag="{Binding DataContext, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=views:MainWindow}}"
                                TileType="{Binding Tile13.Value, Mode=TwoWay}"
                                Visibility="{Binding Tile13.Value.Visibility.Value}">
                                <views:TilePlaceholder.ContextMenu>
                                    <ContextMenu ItemsSource="{Binding Tag.ContextMenuItems, RelativeSource={RelativeSource Self}}" Tag="{Binding PlacementTarget.Tag, RelativeSource={RelativeSource Self}}">
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="Opened">
                                                <helper:EventToCommand Command="{Binding Tag.ContextMenuOpeningCommand, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ContextMenu}}" CommandParameter="13" />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>
                                    </ContextMenu>
                                </views:TilePlaceholder.ContextMenu>
                            </views:TilePlaceholder>
                            <views:TilePlaceholder
                                SelectCommand="{Binding SelectCommand}"
                                Tag="{Binding DataContext, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=views:MainWindow}}"
                                TileType="{Binding Tile14.Value, Mode=TwoWay}"
                                Visibility="{Binding Tile14.Value.Visibility.Value}">
                                <views:TilePlaceholder.ContextMenu>
                                    <ContextMenu ItemsSource="{Binding Tag.ContextMenuItems, RelativeSource={RelativeSource Self}}" Tag="{Binding PlacementTarget.Tag, RelativeSource={RelativeSource Self}}">
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="Opened">
                                                <helper:EventToCommand Command="{Binding Tag.ContextMenuOpeningCommand, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ContextMenu}}" CommandParameter="14" />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>
                                    </ContextMenu>
                                </views:TilePlaceholder.ContextMenu>
                            </views:TilePlaceholder>
                            <views:TilePlaceholder
                                SelectCommand="{Binding SelectCommand}"
                                Tag="{Binding DataContext, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=views:MainWindow}}"
                                TileType="{Binding Tile15.Value, Mode=TwoWay}"
                                Visibility="{Binding Tile15.Value.Visibility.Value}">
                                <views:TilePlaceholder.ContextMenu>
                                    <ContextMenu ItemsSource="{Binding Tag.ContextMenuItems, RelativeSource={RelativeSource Self}}" Tag="{Binding PlacementTarget.Tag, RelativeSource={RelativeSource Self}}">
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="Opened">
                                                <helper:EventToCommand Command="{Binding Tag.ContextMenuOpeningCommand, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ContextMenu}}" CommandParameter="15" />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>
                                    </ContextMenu>
                                </views:TilePlaceholder.ContextMenu>
                            </views:TilePlaceholder>
                            <views:TilePlaceholder
                                SelectCommand="{Binding SelectCommand}"
                                Tag="{Binding DataContext, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=views:MainWindow}}"
                                TileType="{Binding Tile16.Value, Mode=TwoWay}"
                                Visibility="{Binding Tile16.Value.Visibility.Value}">
                                <views:TilePlaceholder.ContextMenu>
                                    <ContextMenu ItemsSource="{Binding Tag.ContextMenuItems, RelativeSource={RelativeSource Self}}" Tag="{Binding PlacementTarget.Tag, RelativeSource={RelativeSource Self}}">
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="Opened">
                                                <helper:EventToCommand Command="{Binding Tag.ContextMenuOpeningCommand, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ContextMenu}}" CommandParameter="16" />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>
                                    </ContextMenu>
                                </views:TilePlaceholder.ContextMenu>
                            </views:TilePlaceholder>
                            <views:TilePlaceholder
                                Margin="10"
                                SelectCommand="{Binding SelectAgariTileCommand}"
                                Tag="{Binding DataContext, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=views:MainWindow}}"
                                TileType="{Binding AgariTile.Value, Mode=TwoWay}"
                                Visibility="{Binding AgariTile.Value.Visibility.Value}">
                                <views:TilePlaceholder.ContextMenu>
                                    <ContextMenu ItemsSource="{Binding Tag.ContextMenuItems, RelativeSource={RelativeSource Self}}" Tag="{Binding PlacementTarget.Tag, RelativeSource={RelativeSource Self}}">
                                        <i:Interaction.Triggers>
                                            <i:EventTrigger EventName="Opened">
                                                <helper:EventToCommand Command="{Binding Tag.ContextMenuOpeningCommand, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ContextMenu}}" CommandParameter="17" />
                                            </i:EventTrigger>
                                        </i:Interaction.Triggers>
                                    </ContextMenu>
                                </views:TilePlaceholder.ContextMenu>
                            </views:TilePlaceholder>
                            <ContentControl VerticalAlignment="Center" Content="{Binding}">
                                <ContentControl.Style>
                                    <Style TargetType="ContentControl">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding AgariTypeAsInt.Value, Converter={StaticResource Enum}, ConverterParameter={x:Static viewModels:AgariType.Unspecified}}" Value="True">
                                                <Setter Property="ContentTemplate">
                                                    <Setter.Value>
                                                        <DataTemplate />
                                                    </Setter.Value>
                                                </Setter>
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding AgariTypeAsInt.Value, Converter={StaticResource Enum}, ConverterParameter={x:Static viewModels:AgariType.Tsumo}}" Value="True">
                                                <Setter Property="ContentTemplate">
                                                    <Setter.Value>
                                                        <DataTemplate>
                                                            <DataTemplate.Resources>
                                                                <Style TargetType="Label">
                                                                    <Setter Property="FontSize" Value="30" />
                                                                    <Setter Property="FontFamily" Value="HGS行書体" />
                                                                </Style>
                                                            </DataTemplate.Resources>
                                                            <Label Content="ツモ" />
                                                        </DataTemplate>
                                                    </Setter.Value>
                                                </Setter>
                                            </DataTrigger>
                                            <DataTrigger Binding="{Binding AgariTypeAsInt.Value, Converter={StaticResource Enum}, ConverterParameter={x:Static viewModels:AgariType.Ron}}" Value="True">
                                                <Setter Property="ContentTemplate">
                                                    <Setter.Value>
                                                        <DataTemplate>
                                                            <DataTemplate.Resources>
                                                                <Style TargetType="Label">
                                                                    <Setter Property="FontSize" Value="30" />
                                                                    <Setter Property="FontFamily" Value="HGS行書体" />
                                                                </Style>
                                                            </DataTemplate.Resources>
                                                            <Label Content="ロン" />
                                                        </DataTemplate>
                                                    </Setter.Value>
                                                </Setter>
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </ContentControl.Style>
                            </ContentControl>
                        </StackPanel>
                        <DockPanel DockPanel.Dock="Right">
                            <StackPanel Orientation="Horizontal">
                                <ItemsControl VerticalAlignment="Center" ItemsSource="{Binding SarashiHai}">
                                    <ItemsControl.ItemTemplateSelector>
                                        <helper:MeldItemTemplateSelector>
                                            <DataTemplate DataType="{x:Type meld:Run}">
                                                <StackPanel Orientation="Horizontal">
                                                    <views:TilePlaceholder LayoutTransform="{Binding Tiles[0].Rotate}" TileType="{Binding Tiles[0]}" />
                                                    <views:TilePlaceholder LayoutTransform="{Binding Tiles[1].Rotate}" TileType="{Binding Tiles[1]}" />
                                                    <views:TilePlaceholder LayoutTransform="{Binding Tiles[2].Rotate}" TileType="{Binding Tiles[2]}" />
                                                </StackPanel>
                                            </DataTemplate>
                                            <DataTemplate DataType="{x:Type meld:Triple}">
                                                <StackPanel Orientation="Horizontal" Tag="{Binding DataContext, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=views:MainWindow}}">
                                                    <StackPanel.ContextMenu>
                                                        <ContextMenu ItemsSource="{Binding Tag.SarashiHaiTripleContextMenuItems, RelativeSource={RelativeSource Self}}" Tag="{Binding PlacementTarget.Tag, RelativeSource={RelativeSource Self}}">
                                                            <i:Interaction.Triggers>
                                                                <i:EventTrigger EventName="Opened">
                                                                    <helper:EventToCommand Command="{Binding Tag.SarashiHaiTripleContextMenuOpeningCommand, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ContextMenu}}" CommandParameter="{Binding AllTiles[0]}" />
                                                                </i:EventTrigger>
                                                            </i:Interaction.Triggers>
                                                        </ContextMenu>
                                                    </StackPanel.ContextMenu>
                                                    <views:TilePlaceholder LayoutTransform="{Binding Tiles[0].Rotate}" TileType="{Binding Tiles[0]}" />
                                                    <views:TilePlaceholder LayoutTransform="{Binding Tiles[1].Rotate}" TileType="{Binding Tiles[1]}" />
                                                    <views:TilePlaceholder LayoutTransform="{Binding Tiles[2].Rotate}" TileType="{Binding Tiles[2]}" />
                                                </StackPanel>
                                            </DataTemplate>
                                            <DataTemplate DataType="{x:Type meld:Quad}">
                                                <ContentControl Content="{Binding}">
                                                    <ContentControl.Style>
                                                        <Style TargetType="ContentControl">
                                                            <Style.Triggers>
                                                                <DataTrigger Binding="{Binding TypeAsInt, Converter={StaticResource Enum}, ConverterParameter={x:Static meld:KongType.ConcealedKong}}" Value="True">
                                                                    <Setter Property="ContentTemplate">
                                                                        <Setter.Value>
                                                                            <DataTemplate>
                                                                                <StackPanel Orientation="Horizontal">
                                                                                    <views:TilePlaceholder BackVisibility="Visible" TileType="{Binding Tiles[0]}" />
                                                                                    <views:TilePlaceholder TileType="{Binding Tiles[1]}" />
                                                                                    <views:TilePlaceholder TileType="{Binding Tiles[2]}" />
                                                                                    <views:TilePlaceholder BackVisibility="Visible" TileType="{Binding Tiles[3]}" />
                                                                                </StackPanel>
                                                                            </DataTemplate>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Binding TypeAsInt, Converter={StaticResource Enum}, ConverterParameter={x:Static meld:KongType.LargeMeldedKong}}" Value="True">
                                                                    <Setter Property="ContentTemplate">
                                                                        <Setter.Value>
                                                                            <DataTemplate>
                                                                                <StackPanel Orientation="Horizontal">
                                                                                    <views:TilePlaceholder LayoutTransform="{Binding Tiles[0].Rotate}" TileType="{Binding Tiles[0]}" />
                                                                                    <views:TilePlaceholder LayoutTransform="{Binding Tiles[1].Rotate}" TileType="{Binding Tiles[1]}" />
                                                                                    <views:TilePlaceholder LayoutTransform="{Binding Tiles[2].Rotate}" TileType="{Binding Tiles[2]}" />
                                                                                    <views:TilePlaceholder LayoutTransform="{Binding Tiles[3].Rotate}" TileType="{Binding Tiles[3]}" />
                                                                                </StackPanel>
                                                                            </DataTemplate>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </DataTrigger>
                                                                <DataTrigger Binding="{Binding TypeAsInt, Converter={StaticResource Enum}, ConverterParameter={x:Static meld:KongType.SmallMeldedKong}}" Value="True">
                                                                    <Setter Property="ContentTemplate">
                                                                        <Setter.Value>
                                                                            <DataTemplate>
                                                                                <views:ShouminkanCandidate />
                                                                            </DataTemplate>
                                                                        </Setter.Value>
                                                                    </Setter>
                                                                </DataTrigger>
                                                            </Style.Triggers>
                                                        </Style>
                                                    </ContentControl.Style>
                                                </ContentControl>
                                            </DataTemplate>
                                        </helper:MeldItemTemplateSelector>
                                    </ItemsControl.ItemTemplateSelector>
                                    <ItemsControl.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <StackPanel Orientation="Horizontal" />
                                        </ItemsPanelTemplate>
                                    </ItemsControl.ItemsPanel>
                                </ItemsControl>
                                <Button
                                    Width="75"
                                    Height="40"
                                    Command="{Binding ClearCommand}"
                                    Content="クリア" />
                            </StackPanel>
                        </DockPanel>
                    </DockPanel>
                </TabItem>
            </TabControl>
        </DockPanel>
        <ScrollViewer>
            <DockPanel Margin="30">
                <DockPanel.Resources>
                    <converters:MatToBitmap x:Key="MatToBitmap" />
                </DockPanel.Resources>
                <TabControl DockPanel.Dock="Right">
                    <TabItem Header="Output">
                        <Image MaxWidth="200" Source="{Binding Output.Value, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource MatToBitmap}}" />
                    </TabItem>
                    <TabItem Header="ClientRect">
                        <Image MaxWidth="200" Source="{Binding ClientRectOutput.Value, UpdateSourceTrigger=PropertyChanged, Converter={StaticResource MatToBitmap}}" />
                    </TabItem>
                </TabControl>
                <ItemsControl ItemsSource="{Binding ReadyHands}">
                    <ItemsControl.ItemsPanel>
                        <ItemsPanelTemplate>
                            <StackPanel Orientation="Vertical" />
                        </ItemsPanelTemplate>
                    </ItemsControl.ItemsPanel>
                    <ItemsControl.ItemTemplate>
                        <DataTemplate>
                            <DockPanel>
                                <StackPanel DockPanel.Dock="Top" Orientation="Horizontal">
                                    <ItemsControl ItemsSource="{Binding Melds}">
                                        <ItemsControl.ItemsPanel>
                                            <ItemsPanelTemplate>
                                                <StackPanel Orientation="Horizontal" />
                                            </ItemsPanelTemplate>
                                        </ItemsControl.ItemsPanel>
                                        <ItemsControl.ItemTemplateSelector>
                                            <helper:MeldItemTemplateSelector>
                                                <DataTemplate DataType="{x:Type meld:OpenWait}">
                                                    <StackPanel Margin="5" Orientation="Horizontal">
                                                        <views:TilePlaceholder TileType="{Binding Tiles[0]}" />
                                                        <views:TilePlaceholder TileType="{Binding Tiles[1]}" />
                                                    </StackPanel>
                                                </DataTemplate>
                                                <DataTemplate DataType="{x:Type meld:ClosedWait}">
                                                    <StackPanel Margin="5" Orientation="Horizontal">
                                                        <views:TilePlaceholder TileType="{Binding Tiles[0]}" />
                                                        <views:TilePlaceholder TileType="{Binding Tiles[1]}" />
                                                    </StackPanel>
                                                </DataTemplate>
                                                <DataTemplate DataType="{x:Type meld:EdgeWait}">
                                                    <StackPanel Margin="5" Orientation="Horizontal">
                                                        <views:TilePlaceholder TileType="{Binding Tiles[0]}" />
                                                        <views:TilePlaceholder TileType="{Binding Tiles[1]}" />
                                                    </StackPanel>
                                                </DataTemplate>
                                                <DataTemplate DataType="{x:Type meld:ThirteenWait}" />
                                                <DataTemplate DataType="{x:Type meld:Single}">
                                                    <views:TilePlaceholder TileType="{Binding Tiles[0]}" />
                                                </DataTemplate>
                                                <DataTemplate DataType="{x:Type meld:Double}">
                                                    <StackPanel Margin="5" Orientation="Horizontal">
                                                        <views:TilePlaceholder TileType="{Binding Tiles[0]}" />
                                                        <views:TilePlaceholder TileType="{Binding Tiles[1]}" />
                                                    </StackPanel>
                                                </DataTemplate>
                                                <DataTemplate DataType="{x:Type meld:Run}">
                                                    <StackPanel Margin="5" Orientation="Horizontal">
                                                        <views:TilePlaceholder LayoutTransform="{Binding Tiles[0].Rotate}" TileType="{Binding Tiles[0]}" />
                                                        <views:TilePlaceholder LayoutTransform="{Binding Tiles[1].Rotate}" TileType="{Binding Tiles[1]}" />
                                                        <views:TilePlaceholder LayoutTransform="{Binding Tiles[2].Rotate}" TileType="{Binding Tiles[2]}" />
                                                    </StackPanel>
                                                </DataTemplate>
                                                <DataTemplate DataType="{x:Type meld:Triple}">
                                                    <StackPanel
                                                        Margin="5"
                                                        Orientation="Horizontal"
                                                        Tag="{Binding DataContext, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=views:MainWindow}}">
                                                        <StackPanel.ContextMenu>
                                                            <ContextMenu ItemsSource="{Binding Tag.SarashiHaiTripleContextMenuItems, RelativeSource={RelativeSource Self}}" Tag="{Binding PlacementTarget.Tag, RelativeSource={RelativeSource Self}}">
                                                                <i:Interaction.Triggers>
                                                                    <i:EventTrigger EventName="Opened">
                                                                        <helper:EventToCommand Command="{Binding Tag.SarashiHaiTripleContextMenuOpeningCommand, RelativeSource={RelativeSource Mode=FindAncestor, AncestorType=ContextMenu}}" CommandParameter="{Binding AllTiles[0]}" />
                                                                    </i:EventTrigger>
                                                                </i:Interaction.Triggers>
                                                            </ContextMenu>
                                                        </StackPanel.ContextMenu>
                                                        <views:TilePlaceholder LayoutTransform="{Binding Tiles[0].Rotate}" TileType="{Binding Tiles[0]}" />
                                                        <views:TilePlaceholder LayoutTransform="{Binding Tiles[1].Rotate}" TileType="{Binding Tiles[1]}" />
                                                        <views:TilePlaceholder LayoutTransform="{Binding Tiles[2].Rotate}" TileType="{Binding Tiles[2]}" />
                                                    </StackPanel>
                                                </DataTemplate>
                                                <DataTemplate DataType="{x:Type meld:Quad}">
                                                    <ContentControl Margin="5" Content="{Binding}">
                                                        <ContentControl.Style>
                                                            <Style TargetType="ContentControl">
                                                                <Style.Triggers>
                                                                    <DataTrigger Binding="{Binding TypeAsInt, Converter={StaticResource Enum}, ConverterParameter={x:Static meld:KongType.ConcealedKong}}" Value="True">
                                                                        <Setter Property="ContentTemplate">
                                                                            <Setter.Value>
                                                                                <DataTemplate>
                                                                                    <StackPanel Orientation="Horizontal">
                                                                                        <views:TilePlaceholder BackVisibility="Visible" TileType="{Binding Tiles[0]}" />
                                                                                        <views:TilePlaceholder TileType="{Binding Tiles[1]}" />
                                                                                        <views:TilePlaceholder TileType="{Binding Tiles[2]}" />
                                                                                        <views:TilePlaceholder BackVisibility="Visible" TileType="{Binding Tiles[3]}" />
                                                                                    </StackPanel>
                                                                                </DataTemplate>
                                                                            </Setter.Value>
                                                                        </Setter>
                                                                    </DataTrigger>
                                                                    <DataTrigger Binding="{Binding TypeAsInt, Converter={StaticResource Enum}, ConverterParameter={x:Static meld:KongType.LargeMeldedKong}}" Value="True">
                                                                        <Setter Property="ContentTemplate">
                                                                            <Setter.Value>
                                                                                <DataTemplate>
                                                                                    <StackPanel Orientation="Horizontal">
                                                                                        <views:TilePlaceholder LayoutTransform="{Binding Tiles[0].Rotate}" TileType="{Binding Tiles[0]}" />
                                                                                        <views:TilePlaceholder LayoutTransform="{Binding Tiles[1].Rotate}" TileType="{Binding Tiles[1]}" />
                                                                                        <views:TilePlaceholder LayoutTransform="{Binding Tiles[2].Rotate}" TileType="{Binding Tiles[2]}" />
                                                                                        <views:TilePlaceholder LayoutTransform="{Binding Tiles[3].Rotate}" TileType="{Binding Tiles[3]}" />
                                                                                    </StackPanel>
                                                                                </DataTemplate>
                                                                            </Setter.Value>
                                                                        </Setter>
                                                                    </DataTrigger>
                                                                    <DataTrigger Binding="{Binding TypeAsInt, Converter={StaticResource Enum}, ConverterParameter={x:Static meld:KongType.SmallMeldedKong}}" Value="True">
                                                                        <Setter Property="ContentTemplate">
                                                                            <Setter.Value>
                                                                                <DataTemplate>
                                                                                    <views:ShouminkanCandidate />
                                                                                </DataTemplate>
                                                                            </Setter.Value>
                                                                        </Setter>
                                                                    </DataTrigger>
                                                                </Style.Triggers>
                                                            </Style>
                                                        </ContentControl.Style>
                                                    </ContentControl>
                                                </DataTemplate>
                                            </helper:MeldItemTemplateSelector>
                                        </ItemsControl.ItemTemplateSelector>
                                    </ItemsControl>
                                    <ItemsControl ItemsSource="{Binding WaitingTiles}">
                                        <ItemsControl.ItemTemplate>
                                            <DataTemplate>
                                                <StackPanel Margin="5" Orientation="Horizontal">
                                                    <views:TilePlaceholder Opacity="0.5" TileType="{Binding}" />
                                                </StackPanel>
                                            </DataTemplate>
                                        </ItemsControl.ItemTemplate>
                                    </ItemsControl>
                                </StackPanel>
                                <StackPanel DockPanel.Dock="Right">
                                    <StackPanel Orientation="Vertical">
                                        <Label HorizontalAlignment="Right" VerticalAlignment="Center">
                                            <Label.Resources>
                                                <TextBlock x:Key="Slum">
                                                    <Run Text="{Binding HuSum.Value, Mode=OneWay}" />
                                                    <Run Text="符" />
                                                    <Run Text="{Binding SumHanCount, Mode=OneWay}" />
                                                    <Run Text="翻" />
                                                    <Run Text="満貫" />
                                                </TextBlock>
                                                <TextBlock x:Key="OneAndHalfSlum">
                                                    <Run Text="{Binding HuSum.Value, Mode=OneWay}" />
                                                    <Run Text="符" />
                                                    <Run Text="{Binding SumHanCount, Mode=OneWay}" />
                                                    <Run Text="翻" />
                                                    <Run Text="跳満" />
                                                </TextBlock>
                                                <TextBlock x:Key="DoubleSlum">
                                                    <Run Text="{Binding HuSum.Value, Mode=OneWay}" />
                                                    <Run Text="符" />
                                                    <Run Text="{Binding SumHanCount, Mode=OneWay}" />
                                                    <Run Text="翻" />
                                                    <Run Text="倍満" />
                                                </TextBlock>
                                                <TextBlock x:Key="TribleSlum">
                                                    <Run Text="{Binding HuSum.Value, Mode=OneWay}" />
                                                    <Run Text="符" />
                                                    <Run Text="{Binding SumHanCount, Mode=OneWay}" />
                                                    <Run Text="翻" />
                                                    <Run Text="三倍満" />
                                                </TextBlock>
                                                <TextBlock x:Key="F">
                                                    <Run Text="{Binding HuSum.Value, Mode=OneWay}" />
                                                    <Run Text="符" />
                                                    <Run Text="{Binding SumHanCount, Mode=OneWay}" />
                                                    <Run Text="翻" />
                                                    <Run Text="役満" />
                                                </TextBlock>
                                                <TextBlock x:Key="DF">
                                                    <Run Text="{Binding HuSum.Value, Mode=OneWay}" />
                                                    <Run Text="符" />
                                                    <Run Text="{Binding SumHanCount, Mode=OneWay}" />
                                                    <Run Text="翻" />
                                                    <Run Text="二倍役満" />
                                                </TextBlock>
                                                <TextBlock x:Key="TF">
                                                    <Run Text="{Binding HuSum.Value, Mode=OneWay}" />
                                                    <Run Text="符" />
                                                    <Run Text="{Binding SumHanCount, Mode=OneWay}" />
                                                    <Run Text="翻" />
                                                    <Run Text="三倍役満" />
                                                </TextBlock>
                                                <TextBlock x:Key="N">
                                                    <Run Text="{Binding HuSum.Value, Mode=OneWay}" />
                                                    <Run Text="符" />
                                                    <Run Text="{Binding SumHanCount, Mode=OneWay}" />
                                                    <Run Text="翻" />
                                                </TextBlock>
                                            </Label.Resources>
                                            <Label.Style>
                                                <Style TargetType="Label">
                                                    <Setter Property="FontSize" Value="50" />
                                                    <Setter Property="FontFamily" Value="HGS行書体" />
                                                    <Style.Triggers>
                                                        <DataTrigger Binding="{Binding SumHanCount, Mode=OneWay, Converter={StaticResource CSlum}}" Value="False">
                                                            <Setter Property="Content" Value="{StaticResource N}" />
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Binding SumHanCount, Mode=OneWay, Converter={StaticResource CSlum}}" Value="True">
                                                            <Setter Property="Content" Value="{StaticResource Slum}" />
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Binding SumHanCount, Mode=OneWay, Converter={StaticResource COneAndHalfOfSlum}}" Value="True">
                                                            <Setter Property="Content" Value="{StaticResource OneAndHalfSlum}" />
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Binding SumHanCount, Mode=OneWay, Converter={StaticResource CDoubleSlum}}" Value="True">
                                                            <Setter Property="Content" Value="{StaticResource DoubleSlum}" />
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Binding SumHanCount, Mode=OneWay, Converter={StaticResource CThreeTimesOfTheSlum}}" Value="True">
                                                            <Setter Property="Content" Value="{StaticResource TribleSlum}" />
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Binding SumHanCount, Mode=OneWay, Converter={StaticResource CFull}}" Value="True">
                                                            <Setter Property="Content" Value="{StaticResource F}" />
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Binding SumHanCount, Mode=OneWay, Converter={StaticResource CDoubleFull}}" Value="True">
                                                            <Setter Property="Content" Value="{StaticResource DF}" />
                                                        </DataTrigger>
                                                        <DataTrigger Binding="{Binding SumHanCount, Mode=OneWay, Converter={StaticResource CTripleFull}}" Value="True">
                                                            <Setter Property="Content" Value="{StaticResource TF}" />
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Label.Style>
                                        </Label>
                                        <Label HorizontalAlignment="Right" VerticalAlignment="Center">
                                            <Label.Style>
                                                <Style TargetType="Label">
                                                    <Setter Property="FontSize" Value="50" />
                                                    <Setter Property="FontFamily" Value="HGS行書体" />
                                                </Style>
                                            </Label.Style>
                                            <Label.Content>
                                                <TextBlock>
                                                    <Run Text="{Binding Score, Mode=OneWay}" />
                                                    <Run Text="点" />
                                                </TextBlock>
                                            </Label.Content>
                                        </Label>
                                    </StackPanel>
                                </StackPanel>
                                <ItemsControl ItemsSource="{Binding Yakus}">
                                    <ItemsControl.ItemsPanel>
                                        <ItemsPanelTemplate>
                                            <WrapPanel Orientation="Vertical" />
                                        </ItemsPanelTemplate>
                                    </ItemsControl.ItemsPanel>
                                    <ItemsControl.ItemTemplate>
                                        <DataTemplate>
                                            <DataTemplate.Resources>
                                                <Style TargetType="Label">
                                                    <Setter Property="FontSize" Value="30" />
                                                    <Setter Property="FontFamily" Value="HGS行書体" />
                                                </Style>
                                            </DataTemplate.Resources>
                                            <StackPanel Orientation="Horizontal">
                                                <Label Content="{Binding Name}" FontSize="30" />
                                                <Label>
                                                    <TextBlock>
                                                        <Run>
                                                            <Run.Text>
                                                                <MultiBinding Converter="{StaticResource HanCountToString}" Mode="OneWay">
                                                                    <Binding />
                                                                    <Binding Path="DataContext.SarashiHai" RelativeSource="{RelativeSource Mode=FindAncestor, AncestorType=views:MainWindow}" />
                                                                </MultiBinding>
                                                            </Run.Text>
                                                        </Run>
                                                    </TextBlock>
                                                </Label>
                                            </StackPanel>
                                        </DataTemplate>
                                    </ItemsControl.ItemTemplate>
                                </ItemsControl>
                            </DockPanel>
                        </DataTemplate>
                    </ItemsControl.ItemTemplate>
                </ItemsControl>
            </DockPanel>
        </ScrollViewer>
    </DockPanel>
</Window>
